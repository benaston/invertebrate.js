!function(invertebrate,$,_,moment){"use strict";function App(templateUrlHelper){function init(){if(!templateUrlHelper)throw"templateUrlHelper not supplied";return _templateServerSvc=templateUrlHelper,that}if(!(this instanceof invertebrate.App))return new invertebrate.App(templateUrlHelper);var that=this,_templateServerSvc=null,_templates={},_templatePostRenderScripts={},_inFlightRequests={};return this.mod=function(){var a={};return function(b){return a[b]?a[b]:a[b]={}}}(),this.fetchTemplate=function(a,b){var c={done:function(){},fail:function(a){throw"fetchTemplate failed. Ensure the TemplateUrlHelper in your application has been instantiated correctly. "+a.status}};b=_.extend({},c,b);var d=20;return _inFlightRequests[a]?void setTimeout(function e(){return _templates[a]?b.done(_templates[a]):void setTimeout(e,d)},d):_templates[a]?b.done(_templates[a]):(_inFlightRequests[a]="inFlight",$.ajax({url:a,cache:!1}).done(function(c){delete _inFlightRequests[a];var d=_.template(c);_templates[a]=d,b.done(d)}).fail(b.fail))},this.fetchTemplateLocal=function(a,b){var c={done:function(){},fail:function(a){throw"fetchTemplateLocal failed."+a.status}};if(b=_.extend({},c,b),_templates[a])return b.done(_templates[a]);var d=$('script[type="text/template"][data-template-uri="'+a+'"]').html();if(!$.trim(d))throw'Local template "'+a+'" is empty.';var e=_.template(d);_templates[a]=e,b.done(e)},this.renderTemplate=function(a,b,c,d){function e(b){if(a.html(b({model:_.clone(c),$:$,moment:moment})),d.postRenderScriptName){var e=_templateServerSvc.getPostRenderScriptUri(d.postRenderScriptName);that.fetchTemplatePostRenderScript(e,function(){_templatePostRenderScripts[e]($,a),d.done(a)})}else d.done(a)}var f={done:function(){},error:function(a,b,c){throw console.log(c),c},postRenderActionScriptUri:null};if(d=_.extend({},f,d),!a)throw"$el1 not supplied";if(!c)throw"model not supplied";var g=_templateServerSvc.getTemplateUri(b);b.match(/-local$/g)?that.fetchTemplateLocal(g,{done:e}):that.fetchTemplate(g,{done:e})},this.fetchTemplatePostRenderScript=function(uri,done){if(!uri)throw"uri not supplied.";if(!done)throw"done not supplied.";return _templatePostRenderScripts[uri]?done(_templatePostRenderScripts[uri]):$.ajax({url:uri,dataType:"text",cache:!1,success:function(data,textStatus,jqXHR){_templatePostRenderScripts[uri]=eval(data).postRenderScript,done(data)}}).fail(function(a,b,c){console.log(c)})},init()}invertebrate.App=App}(invertebrate,$,_,moment),function(a,b){"use strict";function c(c){function d(){return this}if(!(this instanceof a.Config))return new a.Config(c);var e=null;return this.devConfig={},this.prodConfig={},this.sharedConfig={},this.collateConfiguration=function(){switch(this.envEnum=e||a.env,c){case this.envEnum.dev:this.config=b.extend({},this.sharedConfig,this.devConfig);break;case this.envEnum.prod:this.config=b.extend({},this.sharedConfig,this.prodConfig);break;default:throw"invalid environment: "+c}return this},d()}a.Config=c}(invertebrate,_),function(a){a.env={dev:"1",test:"2",prod:"3"}}(invertebrate),window.invertebrate={},function(a){"use strict";function b(){function b(){return c}if(!(this instanceof a.Model))return new a.Model;var c=this;return c.resourceName="not set",b()}a.Model=b,a.Model.prototype.sync=function(){},a.Model.isExtendedBy=function(b){b.prototype=new a.Model,b.prototype.constructor=b}}(invertebrate),function(a,b,c){"use strict";function d(a){function d(a){var c=b(this).attr("href"),d="http//";return null==c?void a.preventDefault():void(c.slice(d.length)!==d&&(a.preventDefault(),h.route(c)))}function e(a){var c=b(this).attr("action"),d="http//";c.slice(d.length)!==d&&(a.preventDefault(),h.route(c,h.createDtoFromForm(b(this))))}function f(a,b){var c={};if(c.__isInvertebrateExternal__=b,""===a)return c;for(var d=0;d<a.length;++d){var e=a[d].split("=");2===e.length&&(c[e[0]]=decodeURIComponent(e[1].replace(/\+/g," ")))}return c}function g(){if(!a)throw"defaultPageTitle not supplied.";i=a,window.addEventListener("popstate",function(){h.route(location.pathname+location.search,null,{silent:!0,isExternal:!0})}),b(document).on("touchstart","button",function(){b(this).addClass("halo")}),b(document).on("touchend","button",function(){b(this).removeClass("halo")}),b(document).on("click","a:not([data-bypass-router])",d),b(document).on("submit","form",e)}var h=this,i=null;this.routes={},this.registerRoute=function(a,b,d){var e={silent:!1,title:i,uriTransform:function(a){return a},isExternal:!1};d=c.extend({},e,d),h.routes[a]={action:b,options:d}},this.redirect=function(a,b,c){h.route(a,b,c)},this.route=function(a,b,d){d=d||{silent:!1};var e=a.split("?"),g=e[0],i=e[1]||"",j=g.replace(/\//g,"\\/"),k=new RegExp("^"+j,"g"),l=c.filter(Object.keys(h.routes),function(a){return k.exec(a)})[0];if(!l)throw'No matching client-side route "'+g+'". Check your route-registry.';var m=h.routes[l];if(m.options.silent||d.silent||(document.title=m.options.title,history.pushState(null,null,m.options.uriTransform(a,b))),b)return void m.action(b);var n=i.split("&");m.action(f(n,d.isExternal))},this.createDtoFromForm=function(a){var b={},d=a.find("input[type=text],input[type=search],input[type=email],input[type=password],input[type=hidden]");c.each(d,function(a){b[a.name]=a.value});var e=a.find("input[type=radio]:checked,input[type=checkbox]:checked");return c.each(e,function(a){b[a.name]=a.value}),b},g()}a.Router=d}(invertebrate,$,_),function(a){"use strict";function b(b,c){function d(){if(!b)throw"configSvc not supplied";return f=b,e.serverUrlSelectionFunc=c||e.serverUrlSelectionFunc,e}if(!(this instanceof a.SyncService))return new a.SyncService(b,c);var e=this,f=null,g=null;return this.serverUrlSelectionFunc=function(){return"./example/templateServer/"},this.sync=function(){},this.start=function(){var a=f.syncInterval||1e4;g=setInterval(function(){e.sync(null)},a)},this.stop=function(){clearInterval(g)},d()}a.SyncService=b}(invertebrate,$),function(a){"use strict";function b(b,c){function d(){if(!b)throw"configSvc not supplied";return f=b,e.serverUrlSelectionFunc=c||e.serverUrlSelectionFunc,e}if(!(this instanceof a.TemplateUrlHelper))return new a.TemplateUrlHelper(b,c);var e=this,f=null;return this.serverUrlSelectionFunc=function(){return"./template-server/"},this.getTemplateUri=function(a){if(!a)throw"templateName not supplied.";var b=f.config.templatesUriPart;if(!b)throw"templatesUriPart empty.";var c=e.serverUrlSelectionFunc();if(!c)throw"serverUri empty.";return""+c+b+a},this.getPostRenderScriptUri=function(a){if(!a)throw"postRenderScriptName not supplied.";var b=f.config.templatePostRenderScriptsUriPart;if(!b)throw"postRenderScriptsUriPart empty.";var c=e.serverUrlSelectionFunc();if(!c)throw"serverUri empty.";return""+c+b+a},d()}a.TemplateUrlHelper=b}(invertebrate),function(a){"use strict";function b(b){function c(){return d}if(!(this instanceof a.View))return new a.View(b);var d=this;return c()}a.View=b,a.View.prototype.onDomReady=function(){},a.View.isExtendedBy=function(b){b.prototype=new a.View,b.prototype.constructor=b}}(invertebrate);